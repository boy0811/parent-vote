{% extends "layout.html" %}

{% block content %}
<div class="container mt-5">
  <h2 class="mb-4 text-center">👥 帳號管理</h2>

  <!-- 功能列 -->
  <div class="d-flex justify-content-between align-items-center mb-3">
    <div>
      <button type="submit" form="delete-form" class="btn btn-danger"
              onclick="return confirm('確定要刪除選中的帳號嗎？')">🗑️ 批次刪除</button>
    </div>
    <div>
      <a href="{{ url_for('admin_users.add_user') }}" class="btn btn-primary me-2">➕ 新增帳號</a>
      <a href="{{ url_for('admin_users.import_users') }}" class="btn btn-outline-info">📥 匯入帳號</a>
    </div>
  </div>

  <!-- 帳號表格 -->
  <form method="POST" id="delete-form" action="{{ url_for('admin_users.delete_users') }}">
    <div class="table-responsive">
      <table class="table table-striped table-hover align-middle shadow-sm">
        <thead class="table-dark">
          <tr>
            <th scope="col" style="width:50px;"><input type="checkbox" id="select-all"></th>
            <th scope="col">帳號</th>
            <th scope="col" style="width:180px;">操作</th>
          </tr>
        </thead>
        <tbody>
          {% for user in users %}
          <tr>
            <td><input type="checkbox" name="user_ids" value="{{ user.id }}"></td>
            <td><span class="fw-bold text-primary">{{ user.username }}</span></td>
            <td>
              <a href="{{ url_for('admin_users.edit_user', user_id=user.id) }}" class="btn btn-sm btn-outline-primary me-1">✏️ 編輯</a>
              <a href="{{ url_for('admin_users.delete_user', user_id=user.id) }}" 
                 class="btn btn-sm btn-outline-danger"
                 onclick="return confirm('確定要刪除這個帳號嗎？')">🗑️ 刪除</a>
            </td>
          </tr>
          {% else %}
          <tr>
            <td colspan="3" class="text-center text-muted">目前沒有帳號資料</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </form>
</div>

<script>
  // 全選 / 全不選
  document.getElementById("select-all").addEventListener("click", function(e) {
    const checkboxes = document.querySelectorAll("input[name='user_ids']");
    checkboxes.forEach(cb => cb.checked = e.target.checked);
  });
</script>
{% endblock %}
